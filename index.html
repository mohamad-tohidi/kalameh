<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù¾Ú˜ÙˆÙ‡Ø´</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/misc/Farsi-Digits/font-face.css " rel="stylesheet" type="text/css" />
    <!-- Adding vis.js for better graph visualization -->
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
   
    <style>
        /* --- 1. Global Variables --- */
        :root {
            --bg-color: #F8F9FA;
            --paper-color: #FFFFFF;
            --text-main: #2D3748;
            --text-muted: #718096;
            --accent-color: #2C7A7B; /* Teal - traditional yet modern */
            --accent-light: #E6FFFA;
            --ghost-color: #A0AEC0;
            --diff-green-bg: #C6F6D5;
            --diff-green-text: #22543D;
            --diff-red-bg: #FED7D7;
            --diff-red-text: #822727;
            --font-main: 'Vazirmatn', sans-serif;
            --border-color: #E2E8F0;
            --cursor-blue: #3182CE;
            --cursor-green: #38A169;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
       
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-main);
            overflow-x: hidden;
            line-height: 1.8;
        }
        /* --- 2. Layout Grid --- */
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            max-width: 1400px;
            margin: 0 auto;
        }
        /* --- 3. The Narrative (Right Column for RTL) --- */
        .scrolly-text {
            padding: 50vh 4rem 50vh 2rem;
            z-index: 10;
            position: relative;
            pointer-events: none;
        }
        .step {
            height: 90vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0.2;
            transition: opacity 0.5s ease, transform 0.5s ease;
            transform: translateY(20px);
            pointer-events: auto;
        }
        .step.active {
            opacity: 1;
            transform: translateY(0);
        }
        .step-content {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 2.5rem;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.04);
            max-width: 500px;
        }
        .step-tag {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            display: block;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .step h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            line-height: 1.3;
            color: #1A202C;
        }
        .step p {
            color: #4A5568;
            font-size: 1.1rem;
        }
        /* --- 4. The Stage (Left Column - Sticky) --- */
        .sticky-stage {
            height: 100vh;
            position: sticky;
            top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            direction: ltr; /* Keeps the mock device centered nicely */
        }
        .device-mockup {
            direction: rtl; /* Content inside is RTL */
            width: 100%;
            max-width: 650px;
            height: 80vh;
            background: var(--paper-color);
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: all 0.5s ease;
            position: relative;
        }
        /* Editor UI Components */
        .editor-header {
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #FAFAFA;
        }
        .doc-title {
            font-weight: 600;
            font-size: 1rem;
            color: #2D3748;
        }
        .doc-tabs {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        .tab.active { color: var(--accent-color); font-weight: bold; border-bottom: 2px solid var(--accent-color); }
        .editor-body {
            flex: 1;
            padding: 3rem 4rem;
            font-size: 1.25rem;
            line-height: 2.2; /* Better for Arabic/Persian script */
            color: var(--text-main);
            overflow-y: hidden;
            position: relative;
            text-align: justify;
        }
        /* --- Feature Visualizations --- */
       
        /* Ghost Writer */
        .ghost-text {
            color: var(--ghost-color);
            animation: fadeIn 1s ease;
        }
       
        .ai-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: var(--accent-color);
            margin-right: 2px;
            vertical-align: middle;
            animation: blink 1s infinite;
        }
        .tab-hint {
            display: inline-block;
            font-family: sans-serif;
            font-size: 0.7rem;
            background: #EDF2F7;
            color: #718096;
            padding: 2px 8px;
            border-radius: 6px;
            margin-right: 10px;
            border: 1px solid #CBD5E0;
            vertical-align: middle;
            opacity: 0;
            transform: translateY(5px);
            transition: all 0.3s ease;
        }
        .tab-hint.visible { opacity: 1; transform: translateY(0); }
        /* Diff View */
        .diff-added {
            background-color: var(--diff-green-bg);
            color: var(--diff-green-text);
            padding: 2px 4px;
            border-radius: 4px;
        }
       
        .diff-removed {
            background-color: var(--diff-red-bg);
            color: var(--diff-red-text);
            text-decoration: line-through;
            padding: 2px 4px;
            border-radius: 4px;
            margin-left: 4px;
            opacity: 0.7;
        }
        /* AI Toolbar */
        .ai-toolbar {
            position: absolute;
            top: 40%;
            left: 2rem;
            background: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            width: 200px;
            opacity: 0;
            transform: scale(0.9) translateX(-20px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 20;
        }
        .ai-toolbar.visible { opacity: 1; transform: scale(1) translateX(0); }
        .btn-accept { width: 100%; background: var(--accent-color); color: white; border: none; padding: 8px; border-radius: 6px; cursor: pointer; font-family: var(--font-main); margin-bottom: 5px;}
        .btn-reject { width: 100%; background: transparent; color: #718096; border: 1px solid #E2E8F0; padding: 8px; border-radius: 6px; cursor: pointer; font-family: var(--font-main); }
        /* History Sidebar (Right Side for RTL) */
        .history-sidebar {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 70px;
            background: #FAFAFA;
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 1.5rem;
            transform: translateX(100%); /* Hidden initially */
            transition: transform 0.4s ease;
            z-index: 5;
        }
        .history-sidebar.visible { transform: translateX(0); }
        .history-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #CBD5E1;
            margin-bottom: 2.5rem;
            position: relative;
            cursor: pointer;
            z-index: 2;
        }
        .history-dot::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 2.5rem;
            background: #E2E8F0;
            left: 50%;
            bottom: -2.5rem;
            transform: translateX(-50%);
            z-index: 1;
        }
        .history-dot:last-child::after { display: none; }
        .history-dot.active { background: var(--accent-color); box-shadow: 0 0 0 4px var(--accent-light); }
       
        .history-tooltip {
            position: absolute;
            right: 30px;
            background: #2D3748;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2;
            pointer-events: none;
        }
        .history-dot:hover .history-tooltip { opacity: 1; }
        /* Graph Visualization */
        .graph-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        #knowledge-graph {
            width: 100%;
            height: 100%;
        }
        
        /* Text Selection Animation */
        .selected-text {
            background-color: rgba(44, 122, 123, 0.2);
            border-radius: 3px;
            animation: pulse 1.5s infinite;
        }
        
        /* AI Command Input */
        .ai-command-input {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        .ai-command-input.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .ai-command-input::before {
            content: ">";
            color: var(--accent-color);
            font-weight: bold;
        }
        .ai-command-text {
            color: var(--text-main);
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        /* Cloud Animation */
        .cloud-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, #f0f9ff, #e0f2fe);
            padding: 2rem;
        }
        .cloud-icon {
            width: 100px;
            height: 60px;
            background: white;
            border-radius: 100px;
            position: relative;
            margin-bottom: 2rem;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        .cloud-icon:before {
            content: '';
            position: absolute;
            top: -25px;
            left: 25px;
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
        }
        .cloud-icon:after {
            content: '';
            position: absolute;
            top: -35px;
            right: 25px;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
        }
        .uploading-files {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 80%;
        }
        .file-item {
            display: flex;
            align-items: center;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            opacity: 0;
            transform: translateX(-20px);
            animation: slideIn 0.5s forwards;
        }
        .file-icon {
            width: 24px;
            height: 24px;
            background: var(--accent-color);
            border-radius: 4px;
            margin-left: 10px;
        }
        .file-name {
            flex: 1;
            font-size: 0.9rem;
        }
        .file-progress {
            width: 100px;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
        }
        .file-progress-bar {
            height: 100%;
            background: var(--accent-color);
            width: 0;
            animation: progress 2s forwards;
        }
        
        /* Collaboration Cursors */
        .cursor {
            position: absolute;
            width: 2px;
            height: 20px;
            border-radius: 2px;
            transition: all 0.3s ease;
            z-index: 100;
        }
        .cursor-blue {
            background-color: var(--cursor-blue);
        }
        .cursor-green {
            background-color: var(--cursor-green);
        }
        .cursor-label {
            position: absolute;
            top: -25px;
            right: 0;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            color: white;
            white-space: nowrap;
            transform: translateX(50%);
        }
        .cursor-blue .cursor-label {
            background-color: var(--cursor-blue);
        }
        .cursor-green .cursor-label {
            background-color: var(--cursor-green);
        }
        
        /* New Introduction Page Styles */
        .intro-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--text-main);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .intro-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%232C7A7B' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .intro-logo {
            width: 80px;
            height: 80px;
            background: var(--accent-color);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px rgba(44, 122, 123, 0.2);
            position: relative;
            z-index: 2;
            animation: float 3s ease-in-out infinite;
        }
        
        .intro-logo::before {
            content: "ğŸ“š";
            font-size: 40px;
        }
        
        .intro-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--text-main);
            position: relative;
            z-index: 2;
        }
        
        .intro-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            color: var(--text-muted);
            max-width: 500px;
            position: relative;
            z-index: 2;
        }
        
        .intro-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            position: relative;
            z-index: 2;
        }
        
        .intro-feature {
            background: white;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .intro-feature:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.1);
        }
        
        .intro-divider {
            width: 50px;
            height: 3px;
            background: var(--accent-color);
            margin: 1.5rem 0;
            border-radius: 3px;
            position: relative;
            z-index: 2;
        }
        
        .intro-description {
            font-size: 1rem;
            color: var(--text-muted);
            max-width: 450px;
            line-height: 1.6;
            margin-bottom: 2rem;
            position: relative;
            z-index: 2;
        }
        
        .intro-cta {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            position: relative;
            z-index: 2;
            box-shadow: 0 4px 12px rgba(44, 122, 123, 0.3);
        }
        
        .intro-cta:hover {
            background-color: #2a6969;
            transform: translateY(-2px);
        }
        
        /* Animations */
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0% { background-color: rgba(44, 122, 123, 0.2); } 50% { background-color: rgba(44, 122, 123, 0.4); } 100% { background-color: rgba(44, 122, 123, 0.2); } }
        @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
        @keyframes progress { to { width: 100%; } }
        @keyframes typing { from { width: 0; } to { width: 100%; } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
    </style>
</head>
<body>
<div class="container">
    <div class="scrolly-text">
        <div class="step" data-index="0">
            <div class="step-content">
                <span class="step-tag">ğŸŒŸ Ù…Ø¹Ø±ÙÛŒ Ù…Ø­ØµÙˆÙ„</span>
                <h2>Ø³Ø§Ù…Ø§Ù†Ù‡ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù¾Ú˜ÙˆÙ‡Ø´</h2>
                <p>Ù¾Ù„ØªÙØ±Ù…ÛŒ Ù†ÙˆÛŒÙ† Ø¨Ø±Ø§ÛŒ Ù¾Ú˜ÙˆÙ‡Ø´Ú¯Ø±Ø§Ù† Ø¹Ù„ÙˆÙ… Ø¯ÛŒÙ†ÛŒ Ú©Ù‡ Ø¨Ø§ Ø¨Ù‡Ø±Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒØŒ ÙØ±Ø¢ÛŒÙ†Ø¯ ØªØ­Ù‚ÛŒÙ‚ØŒ Ù†Ú¯Ø§Ø±Ø´ Ùˆ Ù‡Ù…Ú©Ø§Ø±ÛŒ ØªÛŒÙ…ÛŒ Ø±Ø§ Ù…ØªØ­ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø³Ø§Ø¯Ù‡ØŒ ØªØ¬Ø±Ø¨Ù‡â€ŒØ§ÛŒ Ø¨ÛŒâ€ŒÙ†Ø¸ÛŒØ± Ø§Ø² Ù¾Ú˜ÙˆÙ‡Ø´ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ© Ø±Ø§ ØªØ¬Ø±Ø¨Ù‡ Ú©Ù†ÛŒØ¯.</p>
            </div>
        </div>
        <div class="step" data-index="1">
            <div class="step-content">
                <span class="step-tag">âœ¨ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯</span>
                <h2>ØªØ­Ø±ÛŒØ± Ø¨Ø§ Ø³Ø±Ø¹Øª Ø§Ù†Ø¯ÛŒØ´Ù‡</h2>
                <p>Ø¯ÛŒÚ¯Ø± Ø¨Ø§ ØµÙØ­Ù‡ Ø³ÙÛŒØ¯ Ø±ÙˆØ¨Ø±Ùˆ Ù†Ø®ÙˆØ§Ù‡ÛŒØ¯ Ø´Ø¯. Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¨Ø§ Ø¯Ø±Ú© Ù…ØªÙˆÙ† ÙÙ‚Ù‡ÛŒ Ùˆ Ø±ÙˆØ§ÛŒÛŒØŒ Ø§Ø¯Ø§Ù…Ù‡ Ø¬Ù…Ù„Ù‡ Ø´Ù…Ø§ Ø±Ø§ Ø¨Ù‡ Ø³Ø¨Ú© Ù‚Ø¯Ù…Ø§ ÛŒØ§ Ù…Ø¹Ø§ØµØ±ÛŒÙ† Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯. Ø¨Ø§ ÛŒÚ© Ú©Ù„ÛŒÚ© ØªØ£ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯.</p>
            </div>
        </div>
        <div class="step" data-index="2">
            <div class="step-content">
                <span class="step-tag">âš–ï¸ Ù†Ù‚Ø¯ Ùˆ Ø¨Ø±Ø±Ø³ÛŒ</span>
                <h2>ØªØµØ­ÛŒØ­ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…ØªÙ†</h2>
                <p>Ù…ØªÙ† Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ØªØ§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø³Ù†Ø¯ÛŒØª Ø±ÙˆØ§ÛŒØª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†Ø¯ ÛŒØ§ Ù„Ø­Ù† Ù†ÙˆØ´ØªØ§Ø± Ø±Ø§ Ø§Ø¯ÛŒØ¨Ø§Ù†Ù‡â€ŒØªØ± Ú©Ù†Ø¯. ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø¹Ù…Ø§Ù„ØŒ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
            </div>
        </div>
        <div class="step" data-index="3">
            <div class="step-content">
                <span class="step-tag">ğŸ“œ Ø¨Ø§ÛŒÚ¯Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</span>
                <h2>Ù…Ø§Ø´ÛŒÙ† Ø²Ù…Ø§Ù† Ù¾Ú˜ÙˆÙ‡Ø´</h2>
                <p>Ù†Ú¯Ø±Ø§Ù† Ø§Ø² Ø¯Ø³Øª Ø±ÙØªÙ† Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ù†Ø¨Ø§Ø´ÛŒØ¯. ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„ Ù†Ú¯Ø§Ø±Ø´ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ Ù‡Ø± Ù„Ø­Ø¸Ù‡ Ø§Ø² ØªØ­Ù‚ÛŒÙ‚ Ø®ÙˆØ¯ Ø¨Ø§Ø²Ú¯Ø±Ø¯ÛŒØ¯.</p>
            </div>
        </div>
       
         <div class="step" data-index="4">
            <div class="step-content">
                <span class="step-tag">ğŸ”— Ø´Ø¨Ú©Ù‡ Ø¯Ø§Ù†Ø´</span>
                <h2>Ú¯Ø±Ø§Ù Ø±Ø¬Ø§Ù„ Ùˆ Ú©ØªØ¨</h2>
                <p>Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª Ù¾Ù†Ù‡Ø§Ù† Ø±Ø§ Ú©Ø´Ù Ú©Ù†ÛŒØ¯. Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù†Ø§Ù… Ø±Ø§ÙˆÛŒ ÛŒØ§ Ú©ØªØ§Ø¨ØŒ Ø´Ø¨Ú©Ù‡ Ø§Ø±ØªØ¨Ø§Ø·ÛŒ Ø§Ùˆ Ø¨Ø§ Ø³Ø§ÛŒØ± Ù…Ø´Ø§ÛŒØ® Ùˆ Ø¢Ø«Ø§Ø± Ø¯Ø± ÛŒÚ© Ù†Ù…Ø§ÛŒ Ú¯Ø±Ø§ÙÛŒÚ©ÛŒ Ø²Ù†Ø¯Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
            </div>
        </div>
        
        <div class="step" data-index="5">
            <div class="step-content">
                <span class="step-tag">â˜ï¸ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ Ø§Ù…Ù†</span>
                <h2>Ù¾Ú˜ÙˆÙ‡Ø´ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ø§Ù…Ø§Ù† Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯</h2>
                <p>ØªÙ…Ø§Ù… Ø§Ø³Ù†Ø§Ø¯ Ùˆ ØªØ­Ù‚ÛŒÙ‚Ø§Øª Ø´Ù…Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± ÙØ¶Ø§ÛŒ Ø§Ø¨Ø±ÛŒ Ø§Ù…Ù† Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯. Ø¯ÛŒÚ¯Ø± Ù†Ú¯Ø±Ø§Ù† Ø§Ø² Ø¯Ø³Øª Ø±ÙØªÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ Ø®ÙˆØ¯ Ù†Ø¨Ø§Ø´ÛŒØ¯.</p>
            </div>
        </div>
        
        <div class="step" data-index="6">
            <div class="step-content">
                <span class="step-tag">ğŸ‘¥ Ù‡Ù…Ú©Ø§Ø±ÛŒ ØªÛŒÙ…ÛŒ</span>
                <h2>ØªØ­Ù‚ÛŒÙ‚ Ú¯Ø±ÙˆÙ‡ÛŒ Ù‡Ù…Ø²Ù…Ø§Ù†</h2>
                <p>Ø¨Ø§ Ù‡Ù…Ú©Ø§Ø±Ø§Ù† Ø®ÙˆØ¯ Ø¨Ù‡ ØµÙˆØ±Øª Ù‡Ù…Ø²Ù…Ø§Ù† Ø±ÙˆÛŒ ÛŒÚ© Ø³Ù†Ø¯ Ú©Ø§Ø± Ú©Ù†ÛŒØ¯. Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ù‡Ø± ÙØ±Ø¯ Ø¯Ø± Ú©Ø¬Ø§ÛŒ Ù…ØªÙ† Ø¯Ø± Ø­Ø§Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ø§Ø³Øª Ùˆ ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø²Ù†Ø¯Ù‡ Ø¨Ø¨ÛŒÙ†ÛŒØ¯.</p>
            </div>
        </div>
    </div>
    <div class="sticky-stage">
        <div class="device-mockup" id="editor-mockup">
            <div class="editor-header">
                <div class="doc-title">ØªØ­Ù‚ÛŒÙ‚: Ø­Ø¬ÛŒØª Ø¹Ù‚Ù„ Ø¯Ø± Ø§ØµÙˆÙ„.docx</div>
                <div class="doc-tabs">
                    <span class="tab active" id="tab-write">Ù†Ú¯Ø§Ø±Ø´</span>
                    <span class="tab" id="tab-graph">Ú¯Ø±Ø§Ù Ø¯Ø§Ù†Ø´</span>
                </div>
            </div>
           
            <div class="history-sidebar" id="history-sidebar">
                <div class="history-dot" title=""><span class="history-tooltip">Ø¢ØºØ§Ø² Ù†Ú¯Ø§Ø±Ø´</span></div>
                <div class="history-dot" title=""><span class="history-tooltip">Ø§ÙØ²ÙˆØ¯Ù† Ø±ÙˆØ§ÛŒØª</span></div>
                <div class="history-dot active" title=""><span class="history-tooltip">Ù†Ø³Ø®Ù‡ ÙØ¹Ù„ÛŒ</span></div>
            </div>
            <div class="editor-body" id="editor-content">
                </div>
           
            <div class="ai-toolbar" id="ai-toolbar">
                <div style="font-size: 0.8rem; color: #718096; margin-bottom: 8px;">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ:</div>
                <div style="font-weight: bold; margin-bottom: 10px; font-size: 0.9rem;">Ø§ØµÙ„Ø§Ø­ Ø³Ø§Ù„ ÙˆÙØ§Øª Ùˆ Ù…Ù†Ø¨Ø¹</div>
                <button class="btn-accept">Ù¾Ø°ÛŒØ±Ø´ ØªØºÛŒÛŒØ±Ø§Øª</button>
                <button class="btn-reject">Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ú¯Ø±ÙØªÙ†</button>
            </div>
            
            <div class="ai-command-input" id="ai-command-input">
                <div class="ai-command-text" id="command-text"></div>
            </div>
            
            <div class="cursor cursor-blue" id="cursor-blue" style="display: none;">
                <div class="cursor-label">ÙˆÛŒØ±Ø§Ø³ØªØ§Ø±</div>
            </div>
            
            <div class="cursor cursor-green" id="cursor-green" style="display: none;">
                <div class="cursor-label">Ù…Ø­Ù‚Ù‚</div>
            </div>
        </div>
    </div>
</div>
<script>
    // --- Configuration ---
    const editorContent = document.getElementById('editor-content');
    const steps = document.querySelectorAll('.step');
    const aiToolbar = document.getElementById('ai-toolbar');
    const historySidebar = document.getElementById('history-sidebar');
    const mockup = document.getElementById('editor-mockup');
    const tabWrite = document.getElementById('tab-write');
    const tabGraph = document.getElementById('tab-graph');
    const aiCommandInput = document.getElementById('ai-command-input');
    const commandText = document.getElementById('command-text');
    const cursorBlue = document.getElementById('cursor-blue');
    const cursorGreen = document.getElementById('cursor-green');
    
    // Graph data for the knowledge graph
    let graphNetwork = null;
    
    // --- State Renderer ---
    function renderState(index) {
        // Reset Styles
        aiToolbar.classList.remove('visible');
        historySidebar.classList.remove('visible');
        aiCommandInput.classList.remove('visible');
        cursorBlue.style.display = 'none';
        cursorGreen.style.display = 'none';
        editorContent.style.paddingRight = "4rem"; // Default styling
        tabWrite.classList.add('active');
        tabGraph.classList.remove('active');
        
        if (index === 0) {
            // STATE 0: NEW IMPROVED INTRODUCTION PAGE
            editorContent.innerHTML = `
                <div class="intro-container">
                    <div class="intro-background"></div>
                    <div class="intro-logo"></div>
                    <h1 class="intro-title">Ø³Ø§Ù…Ø§Ù†Ù‡ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù¾Ú˜ÙˆÙ‡Ø´</h1>
                    <div class="intro-divider"></div>
                    <p class="intro-description">Ù¾Ù„ØªÙØ±Ù…ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù¾Ú˜ÙˆÙ‡Ø´Ú¯Ø±Ø§Ù† Ø¹Ù„ÙˆÙ… Ø¯ÛŒÙ†ÛŒ Ú©Ù‡ Ø¨Ø§ Ø¨Ù‡Ø±Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒØŒ ÙØ±Ø¢ÛŒÙ†Ø¯ ØªØ­Ù‚ÛŒÙ‚ Ùˆ Ù†Ú¯Ø§Ø±Ø´ Ø±Ø§ Ù…ØªØ­ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</p>
                    <div class="intro-features">
                        <div class="intro-feature">âœï¸ Ù†Ú¯Ø§Ø±Ø´ Ù‡ÙˆØ´Ù…Ù†Ø¯</div>
                        <div class="intro-feature">ğŸ” ØªØ­Ù„ÛŒÙ„ Ù…ØªÙˆÙ†</div>
                        <div class="intro-feature">ğŸ“Š Ú¯Ø±Ø§Ù Ø¯Ø§Ù†Ø´</div>
                        <div class="intro-feature">â˜ï¸ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ</div>
                        <div class="intro-feature">ğŸ‘¥ Ù‡Ù…Ú©Ø§Ø±ÛŒ ØªÛŒÙ…ÛŒ</div>
                    </div>
                    <button class="intro-cta">Ø´Ø±ÙˆØ¹ Ù¾Ú˜ÙˆÙ‡Ø´</button>
                </div>
            `;
        }
        else if (index === 1) {
            // STATE 1: GHOST WRITING (Persian)
            editorContent.innerHTML = `
                <p>Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ø±Ø§Ø¡ Ø§ØµÙˆÙ„ÛŒÙˆÙ† Ù¾ÛŒØ±Ø§Ù…ÙˆÙ† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø¹Ù‚Ù„ØŒ Ø´ÛŒØ® Ø·ÙˆØ³ÛŒ Ø¯Ø± Ú©ØªØ§Ø¨ Â«Ø§Ù„Ø¹ÙØ¯Ù‘Ø©Â» Ù…ÛŒâ€ŒÙØ±Ù…Ø§ÛŒØ¯ Ú©Ù‡</p>
                <p>Ø¹Ù‚Ù„ØŒ Ú©Ø§Ø´Ù Ø§Ø² Ø­Ú©Ù… Ø´Ø±Ø¹ÛŒ Ø§Ø³Øª Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ù…Ù„Ø§Ø²Ù…Ù‡â€ŒØ§ÛŒ Ø¨ÛŒÙ†</p>
                <p>Ø­Ú©Ù… Ø¹Ù‚Ù„ Ùˆ Ø´Ø±Ø¹ Ø¨Ø§Ø´Ø¯. Ø§Ù…Ø§ Ø§Ø®Ø¨Ø§Ø±ÛŒÙˆÙ† Ù…Ø¹ØªÙ‚Ø¯Ù†Ø¯ Ú©Ù‡ <span class="ghost-text">Ø¹Ù‚Ù„ Ø¨Ù‡ ØªÙ†Ù‡Ø§ÛŒÛŒ Ø­Ø¬Øª Ù†ÛŒØ³Øª Ù…Ú¯Ø± Ø¨Ø§ ØªØ£ÛŒÛŒØ¯ Ù†Øµ ØµØ±ÛŒØ­...</span><span class="tab-hint visible">Tab</span><span class="ai-cursor"></span></p>
            `;
        }
        else if (index === 2) {
            // STATE 2: DIFF VIEW with enhanced animations
            editorContent.innerHTML = `
                <p>Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ø±Ø§Ø¡ Ø§ØµÙˆÙ„ÛŒÙˆÙ† Ù¾ÛŒØ±Ø§Ù…ÙˆÙ† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø¹Ù‚Ù„ØŒ Ø´ÛŒØ® Ø·ÙˆØ³ÛŒ Ø¯Ø± Ú©ØªØ§Ø¨ Â«Ø§Ù„Ø¹ÙØ¯Ù‘Ø©Â» Ù…ÛŒâ€ŒÙØ±Ù…Ø§ÛŒØ¯ Ú©Ù‡ Ø¹Ù‚Ù„ØŒ Ú©Ø§Ø´Ù Ø§Ø² Ø­Ú©Ù… Ø´Ø±Ø¹ÛŒ Ø§Ø³Øª.</p>
                <br>
                <p>Ø±ÙˆØ§ÛŒØª: Ø²Ø±Ø§Ø±Ø© Ø¨Ù† Ø£Ø¹ÛŒÙ† Ø§Ø² Ø§Ù…Ø§Ù… ØµØ§Ø¯Ù‚ (Ø¹) Ù†Ù‚Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:</p>
                <p id="text-to-select">Â«Ø­Ø¯ÛŒØ« Ø¶Ø¹ÛŒÙ Ø§Ø³Øª Ú†ÙˆÙ† Ø³Ù†Ø¯Ø´ Ù‚Ø·Ø¹ Ø´Ø¯Ù‡.Â»</p>
            `;
            
            // Animate text selection
            setTimeout(() => {
                const textElement = document.getElementById('text-to-select');
                textElement.classList.add('selected-text');
                
                // Show AI command input
                aiCommandInput.classList.add('visible');
                commandText.innerHTML = '';
                typeCommand("Ø¨Ø±Ø±Ø³ÛŒ Ø³Ù†Ø¯ÛŒØª Ø±ÙˆØ§ÛŒØª");
                
                // After command is typed, show the diff
                setTimeout(() => {
                    textElement.innerHTML = `
                        <span class="diff-removed">Â«Ø­Ø¯ÛŒØ« Ø¶Ø¹ÛŒÙ Ø§Ø³Øª Ú†ÙˆÙ† Ø³Ù†Ø¯Ø´ Ù‚Ø·Ø¹ Ø´Ø¯Ù‡.Â»</span>
                        <span class="diff-added">Â«Ø§ÛŒÙ† Ø±ÙˆØ§ÛŒØª Ù…Ø±Ø³Ù„Ù‡ Ø§Ø³Øª Ø§Ù…Ø§ Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø¹Ù…Ù„ Ø§ØµØ­Ø§Ø¨ØŒ Ù…ÙˆØ«Ù‚ ØªÙ„Ù‚ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.Â»</span>
                    `;
                    textElement.classList.remove('selected-text');
                    aiToolbar.classList.add('visible');
                }, 2000);
            }, 1000);
        }
        else if (index === 3) {
            // STATE 3: HISTORY / VERSIONING
            // Shift content to allow Sidebar on the RIGHT
            editorContent.style.paddingRight = "6rem";
            historySidebar.classList.add('visible');
           
            editorContent.innerHTML = `
                <h3 style="margin-bottom: 1rem; color: #2C7A7B;">Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ù†Ù‡Ø§ÛŒÛŒ</h3>
                <p>Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ†ØŒ Ø±ÙˆÛŒÚ©Ø±Ø¯ Ø§Ø¹ØªØ¯Ø§Ù„ÛŒ Ø¯Ø± Ø¬Ù…Ø¹ Ø¨ÛŒÙ† Ø¹Ù‚Ù„ Ùˆ Ù†Ù‚Ù„ØŒ Ù‡Ù…Ø§Ù† Ù…Ø³ÛŒØ±ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø§Ú©Ø«Ø± ÙÙ‚Ù‡Ø§ÛŒ Ø§Ù…Ø§Ù…ÛŒÙ‡ Ù¾ÛŒÙ…ÙˆØ¯Ù‡â€ŒØ§Ù†Ø¯. (Ù†Ø³Ø®Ù‡ Ù†Ù‡Ø§ÛŒÛŒ)</p>
                <div style="margin-top: 2rem; border-top: 1px dashed #ccc; padding-top: 1rem; font-size: 0.9rem; color: #718096;">
                    <span style="font-weight: bold;">Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±:</span> ØªØºÛŒÛŒØ±Ø§Øª ÙØµÙ„ Ø³ÙˆÙ… Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯.
                </div>
            `;
        }
        else if (index === 4) {
            // STATE 4: KNOWLEDGE GRAPH using vis.js
            tabWrite.classList.remove('active');
            tabGraph.classList.add('active');
            historySidebar.classList.remove('visible');
            editorContent.style.paddingRight = "2rem";
            
            // Create a container for the graph
            editorContent.innerHTML = '<div id="knowledge-graph"></div>';
            
            // Create a network
            const container = document.getElementById('knowledge-graph');
            
            // Create nodes for the narration chain
            const nodes = new vis.DataSet([
                {id: 1, label: 'Ø§Ù…Ø§Ù… ØµØ§Ø¯Ù‚ (Ø¹)', group: 'imam', value: 30},
                {id: 2, label: 'Ø²Ø±Ø§Ø±Ø© Ø¨Ù† Ø£Ø¹ÛŒÙ†', group: 'companion', value: 25},
                {id: 3, label: 'Ø­Ù…Ø±Ø§Ù† Ø¨Ù† Ø£Ø¹ÛŒÙ†', group: 'companion', value: 20},
                {id: 4, label: 'Ù…Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø³Ù„Ù…', group: 'companion', value: 20},
                {id: 5, label: 'Ø§Ø¨ÛŒ Ø¨ØµÛŒØ±', group: 'companion', value: 20},
                {id: 6, label: 'Ú©ØªØ¨ Ø§Ø±Ø¨Ø¹Ù‡', group: 'book', value: 15},
                {id: 7, label: 'Ù…Ù† Ù„Ø§ÛŒØ­Ø¶Ø±Ù‡ Ø§Ù„ÙÙ‚ÛŒÙ‡', group: 'book', value: 15},
                {id: 8, label: 'ØªÙ‡Ø°ÛŒØ¨ Ø§Ù„Ø§Ø­Ú©Ø§Ù…', group: 'book', value: 15},
                {id: 9, label: 'Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±', group: 'book', value: 15},
                {id: 10, label: 'Ø´ÛŒØ® Ú©Ù„ÛŒÙ†ÛŒ', group: 'scholar', value: 20},
                {id: 11, label: 'Ø´ÛŒØ® ØµØ¯ÙˆÙ‚', group: 'scholar', value: 20},
                {id: 12, label: 'Ø´ÛŒØ® Ø·ÙˆØ³ÛŒ', group: 'scholar', value: 20}
            ]);
            
            // Create edges showing the narration chain
            const edges = new vis.DataSet([
                {from: 1, to: 2, label: 'Ø±ÙˆØ§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯', arrows: 'to'},
                {from: 1, to: 3, label: 'Ø±ÙˆØ§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯', arrows: 'to'},
                {from: 1, to: 4, label: 'Ø±ÙˆØ§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯', arrows: 'to'},
                {from: 1, to: 5, label: 'Ø±ÙˆØ§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯', arrows: 'to'},
                {from: 2, to: 6, label: 'Ø¯Ø±', arrows: 'to'},
                {from: 3, to: 7, label: 'Ø¯Ø±', arrows: 'to'},
                {from: 4, to: 8, label: 'Ø¯Ø±', arrows: 'to'},
                {from: 5, to: 9, label: 'Ø¯Ø±', arrows: 'to'},
                {from: 6, to: 10, label: 'ØªØ£Ù„ÛŒÙ', arrows: 'to'},
                {from: 7, to: 11, label: 'ØªØ£Ù„ÛŒÙ', arrows: 'to'},
                {from: 8, to: 12, label: 'ØªØ£Ù„ÛŒÙ', arrows: 'to'},
                {from: 9, to: 12, label: 'ØªØ£Ù„ÛŒÙ', arrows: 'to'},
                {from: 10, to: 11, label: 'Ù‡Ù…â€ŒØ¹ØµØ±', arrows: 'to', color: {color: '#ccc'}},
                {from: 11, to: 12, label: 'Ù‡Ù…â€ŒØ¹ØµØ±', arrows: 'to', color: {color: '#ccc'}}
            ]);
            
            const data = {
                nodes: nodes,
                edges: edges
            };
            
            const options = {
                groups: {
                    imam: {
                        color: {background: '#2C7A7B', border: '#1A5A5B'},
                        font: {color: 'white'}
                    },
                    companion: {
                        color: {background: '#4299E1', border: '#2B6CB0'},
                        font: {color: 'white'}
                    },
                    scholar: {
                        color: {background: '#805AD5', border: '#6B46C1'},
                        font: {color: 'white'}
                    },
                    book: {
                        color: {background: '#ED8936', border: '#C05621'},
                        font: {color: 'white'},
                        shape: 'box'
                    }
                },
                nodes: {
                    shape: 'dot',
                    scaling: {
                        min: 20,
                        max: 30
                    },
                    font: {
                        size: 12,
                        face: 'Vazirmatn',
                        direction: 'rtl'
                    }
                },
                edges: {
                    width: 2,
                    color: {inherit: 'from'},
                    smooth: {
                        type: 'continuous'
                    },
                    font: {
                        size: 10,
                        face: 'Vazirmatn',
                        direction: 'rtl',
                        align: 'middle'
                    }
                },
                physics: {
                    stabilization: {
                        iterations: 200
                    },
                    barnesHut: {
                        gravitationalConstant: -30000,
                        springConstant: 0.04,
                        springLength: 100
                    }
                },
                interaction: {
                    tooltipDelay: 200,
                    hideEdgesOnDrag: true
                }
            };
            
            // Create the network
            graphNetwork = new vis.Network(container, data, options);
            
            // Add a legend
            const legendContainer = document.createElement('div');
            legendContainer.style.position = 'absolute';
            legendContainer.style.bottom = '10px';
            legendContainer.style.left = '10px';
            legendContainer.style.background = 'rgba(255,255,255,0.8)';
            legendContainer.style.padding = '10px';
            legendContainer.style.borderRadius = '5px';
            legendContainer.style.fontSize = '12px';
            legendContainer.style.fontFamily = 'Vazirmatn';
            legendContainer.style.direction = 'rtl';
            
            legendContainer.innerHTML = `
                <div style="display:flex; align-items:center; gap:5px; margin-bottom:5px;">
                    <div style="width:10px;height:10px;background:#2C7A7B;border-radius:50%"></div> Ø§Ù…Ø§Ù…
                </div>
                <div style="display:flex; align-items:center; gap:5px; margin-bottom:5px;">
                    <div style="width:10px;height:10px;background:#4299E1;border-radius:50%"></div> Ø±Ø§ÙˆÛŒ
                </div>
                <div style="display:flex; align-items:center; gap:5px; margin-bottom:5px;">
                    <div style="width:10px;height:10px;background:#805AD5;border-radius:50%"></div> Ø¹Ø§Ù„Ù…
                </div>
                <div style="display:flex; align-items:center; gap:5px;">
                    <div style="width:10px;height:10px;background:#ED8936;border-radius:2px"></div> Ú©ØªØ§Ø¨
                </div>
            `;
            
            container.appendChild(legendContainer);
        }
        else if (index === 5) {
            // STATE 5: CLOUD SAVING
            tabWrite.classList.add('active');
            tabGraph.classList.remove('active');
            historySidebar.classList.remove('visible');
            editorContent.style.paddingRight = "2rem";
            
            editorContent.innerHTML = `
                <div class="cloud-container">
                    <div class="cloud-icon"></div>
                    <h3 style="color: var(--text-main); margin-bottom: 1rem;">Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù…Ù† Ø¯Ø± ÙØ¶Ø§ÛŒ Ø§Ø¨Ø±ÛŒ</h3>
                    <div class="uploading-files">
                        <div class="file-item" style="animation-delay: 0.5s;">
                            <div class="file-icon"></div>
                            <div class="file-name">ØªØ­Ù‚ÛŒÙ‚: Ø­Ø¬ÛŒØª Ø¹Ù‚Ù„ Ø¯Ø± Ø§ØµÙˆÙ„.docx</div>
                            <div class="file-progress">
                                <div class="file-progress-bar"></div>
                            </div>
                        </div>
                        <div class="file-item" style="animation-delay: 1s;">
                            <div class="file-icon"></div>
                            <div class="file-name">Ù…Ù†Ø§Ø¨Ø¹ Ùˆ Ù…Ø¢Ø®Ø°.bib</div>
                            <div class="file-progress">
                                <div class="file-progress-bar" style="animation-delay: 0.5s;"></div>
                            </div>
                        </div>
                        <div class="file-item" style="animation-delay: 1.5s;">
                            <div class="file-icon"></div>
                            <div class="file-name">ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§.pdf</div>
                            <div class="file-progress">
                                <div class="file-progress-bar" style="animation-delay: 1s;"></div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 2rem; text-align: center; color: var(--text-muted); font-size: 0.9rem;">
                        ØªÙ…Ø§Ù… Ø§Ø³Ù†Ø§Ø¯ Ø´Ù…Ø§ Ø¨Ø§ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù…Ø­Ø§ÙØ¸Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
                    </div>
                </div>
            `;
        }
        else if (index === 6) {
            // STATE 6: COLLABORATION
            tabWrite.classList.add('active');
            tabGraph.classList.remove('active');
            historySidebar.classList.remove('visible');
            editorContent.style.paddingRight = "2rem";
            
            editorContent.innerHTML = `
                <div style="position: relative;">
                    <h3 style="margin-bottom: 1rem; color: #2C7A7B;">ÙØµÙ„ Ø§ÙˆÙ„: Ù…Ù‚Ø¯Ù…Ù‡</h3>
                    <p id="paragraph1" style="margin-bottom: 1rem;">Ø¯Ø± Ø§ÛŒÙ† ÙØµÙ„ Ø¨Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¨Ø§Ù†ÛŒ Ùˆ Ø§ØµÙˆÙ„ Ø§ÙˆÙ„ÛŒÙ‡ Ø­Ø¬ÛŒØª Ø¹Ù‚Ù„ Ø¯Ø± ÙÙ‚Ù‡ Ø´ÛŒØ¹Ù‡ Ù…ÛŒâ€ŒÙ¾Ø±Ø¯Ø§Ø²ÛŒÙ…. Ø§ÛŒÙ† Ù…Ø¨Ø§Ù†ÛŒ Ø§Ø² Ù‚Ø±Ø¢Ù† Ùˆ Ø³Ù†Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡ Ùˆ Ø¯Ø± Ú©Ù„Ø§Ù… ÙÙ‚Ù‡Ø§ Ø¨Ù‡ ØªÙØµÛŒÙ„ Ø¨ÛŒØ§Ù† Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                    <p id="paragraph2" style="margin-bottom: 1rem;">Ø¹Ù‚Ù„ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ©ÛŒ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ú†Ù‡Ø§Ø±Ú¯Ø§Ù†Ù‡ Ø§Ø³ØªÙ†Ø¨Ø§Ø· Ø§Ø­Ú©Ø§Ù…ØŒ Ø¬Ø§ÛŒÚ¯Ø§Ù‡ ÙˆÛŒÚ˜Ù‡â€ŒØ§ÛŒ Ø¯Ø§Ø±Ø¯. Ø§ÛŒÙ† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø± Ù…ÛŒØ§Ù† ÙÙ‚Ù‡Ø§ Ù…ÙˆØ±Ø¯ Ø¨Ø­Ø« Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡ Ùˆ Ù†Ø¸Ø±Ø§Øª Ù…Ø®ØªÙ„ÙÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø§Ø±Ù‡ Ù…Ø·Ø±Ø­ Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                    <p id="paragraph3">Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ØŒ Ø¨Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ø±Ø§Ø¡ Ø¨Ø±Ø¬Ø³ØªÙ‡ ÙÙ‚Ù‡Ø§ Ø¯Ø± Ø§ÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ø®ÙˆØ§Ù‡ÛŒÙ… Ù¾Ø±Ø¯Ø§Ø®Øª Ùˆ Ù†Ø´Ø§Ù† Ø®ÙˆØ§Ù‡ÛŒÙ… Ø¯Ø§Ø¯ Ú©Ù‡ Ú†Ú¯ÙˆÙ†Ù‡ Ø¹Ù‚Ù„ Ø¯Ø± Ú©Ù†Ø§Ø± Ø¯ÛŒÚ¯Ø± Ù…Ù†Ø§Ø¨Ø¹ØŒ Ø¨Ù‡ Ø§Ø³ØªÙ†Ø¨Ø§Ø· Ø§Ø­Ú©Ø§Ù… Ø´Ø±Ø¹ÛŒ Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
                </div>
            `;
            
            // Show cursors after a delay
            setTimeout(() => {
                cursorBlue.style.display = 'block';
                cursorGreen.style.display = 'block';
                
                // Animate cursor blue (ÙˆÛŒØ±Ø§Ø³ØªØ§Ø±)
                animateCursor(cursorBlue, 'paragraph1', 500);
                
                // Animate cursor green (Ù…Ø­Ù‚Ù‚) after a delay
                setTimeout(() => {
                    animateCursor(cursorGreen, 'paragraph2', 800);
                }, 1000);
            }, 500);
        }
    }
    
    // Function to animate typing a command
    function typeCommand(command) {
        let i = 0;
        const interval = setInterval(() => {
            if (i < command.length) {
                commandText.innerHTML = command.substring(0, i + 1);
                i++;
            } else {
                clearInterval(interval);
            }
        }, 50);
    }
    
    // Function to animate cursor movement and typing
    function animateCursor(cursor, paragraphId, duration) {
        const paragraph = document.getElementById(paragraphId);
        const rect = paragraph.getBoundingClientRect();
        const editorRect = editorContent.getBoundingClientRect();
        
        // Calculate position relative to editor
        const top = rect.top - editorRect.top + 10;
        const right = editorRect.width - rect.right + 10;
        
        // Position cursor
        cursor.style.top = `${top}px`;
        cursor.style.right = `${right}px`;
        
        // Animate typing effect
        setTimeout(() => {
            let originalText = paragraph.textContent;
            let i = 0;
            paragraph.textContent = '';
            
            const typeInterval = setInterval(() => {
                if (i < originalText.length) {
                    paragraph.textContent += originalText[i];
                    // Update cursor position
                    const textWidth = getTextWidth(paragraph.textContent.substring(0, i + 1), '1.25rem Vazirmatn');
                    cursor.style.right = `${editorRect.width - rect.right + 10 + textWidth}px`;
                    i++;
                } else {
                    clearInterval(typeInterval);
                }
            }, 30);
        }, 500);
    }
    
    // Function to calculate text width
    function getTextWidth(text, font) {
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        context.font = font;
        return context.measureText(text).width;
    }
    
    // --- Intersection Observer ---
    const observerOptions = {
        root: null,
        rootMargin: '-40% 0px -40% 0px',
        threshold: 0
    };
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                steps.forEach(s => s.classList.remove('active'));
                entry.target.classList.add('active');
                renderState(parseInt(entry.target.getAttribute('data-index')));
            }
        });
    }, observerOptions);
    steps.forEach(step => observer.observe(step));
    // Initial render
    renderState(0);
    steps[0].classList.add('active');
</script>
</body>
</html>